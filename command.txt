drop table if exists test;
drop table if exists test1;
drop table if exists test2;

create table test as
select global_id, array_agg(start_node) AS points
from all_extra_ways 
group by global_id
union
select global_id, array_agg(end_node) AS points
from all_extra_ways 
group by global_id;


select global_id, points from test
where global_id = 201906809;		

create table test1 as 
select distinct w1.local_id, ST_MakeLine(t1.points[array_position(t1.points, w1.start_node) : array_position(t1.points, w1.end_node)]) as linestring
from test t1, extra_ways w1
where t1.global_id = w1.global_id  and t1.global_id = 201906809																 
order by w1.local_id;

create table test2 as 
select local_id, linestring 
from test1																											 
where linestring <> '';

select * from test2