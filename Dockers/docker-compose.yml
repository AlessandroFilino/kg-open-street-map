version: "3.8"

# creo una sola immagine per entrambi i nodi (base_node_image) basata sul Dockerfile
name: kg-open-street-map
services:
  postgres:
          image: postgis/postgis
          restart: always
          environment:
            - POSTGRES_USER=admin
            - POSTGRES_PASSWORD=admin
            - POSTGRES_DB=map
          logging:
            options:
              max-size: 10m
              max-file: "3"
          ports:
            - '5432:5432'
          volumes: 
            - ./postgresDB/postgres-data:/var/lib/postgresql/data
  
  ubuntu:
          image: ubuntu
          build:
            #directory base, con il . Ã¨ la stessa del compose.yml
            context: . 
            dockerfile: Dockerfile
          volumes:
            - ./scripts:/home/scripts
          # modificanto l'entrypoint il container appena viene lanciato esegue lo script 
          entrypoint: sh -c "/home/scripts/script_test.sh"    